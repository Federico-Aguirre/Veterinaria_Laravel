const m=document.querySelector.bind(document),E=document.querySelectorAll.bind(document);document.getElementById.bind(document);const y=document.getElementsByClassName.bind(document);window.matchMedia("(min-width: 800px)");document.addEventListener("DOMContentLoaded",function(){const t=document.getElementById("amount"),e=document.getElementById("paypal-button-container");if(!t||!e||typeof paypal>"u"){console.error("PayPal no está disponible o faltan elementos");return}paypal.Buttons({createOrder:function(r,o){return o.order.create({purchase_units:[{amount:{value:t.getAttribute("data-value")}}]})},onApprove:function(r,o){return o.order.capture().then(function(a){fetch("/obtenerCantidadProductosEnCarro").then(i=>i.json()).then(i=>{fetch("/finalizar-compra",{method:"POST",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content"),"Content-Type":"application/json"},body:JSON.stringify({})}).then(n=>n.json()).then(n=>{if(n.success){const l=document.getElementById("contador-carrito");document.querySelector(".carro-container"),l.offsetHeight,alert("Compra realizada con éxito."),window.location.href=n.redirect}else alert("Hubo un error al finalizar la compra.")}).catch(n=>{console.error("Error:",n),alert("Hubo un error al procesar la compra.")})}).catch(i=>{console.error("Error al obtener la cantidad del carrito:",i),alert("Hubo un error al intentar actualizar el carrito.")})})}}).render("#paypal-button-container")});document.addEventListener("DOMContentLoaded",function(){let t=new Date,e=t.getDate(),r=t.getMonth()+1,o=t.getUTCFullYear();e<10&&(e="0"+e),r<10&&(r="0"+r);let a=`${o}-${r}-${e}T00:00`,i=`${o+2}-${r}-${e}T23:59`;const n=m(".turnos__formulario__fecha"),l=document.getElementById("fecha");l&&l.addEventListener("click",function(){l.showPicker()}),n&&(n.setAttribute("min",a),n.setAttribute("max",i),n.setAttribute("step","1800"),n.addEventListener("input",function(){new Date(n.value).getMinutes()%30!==0&&(alert("Solo puedes seleccionar horarios en intervalos de 30 minutos (por ejemplo, 13:00, 13:30, 14:00, etc.)."),n.value="")}),n.addEventListener("change",function(){const h=n.value;fetch("/verificar-turno",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({fecha:h})}).then(f=>f.json()).then(f=>{f.ocupado&&(alert("Ya existe un turno en esta fecha y hora. Por favor, selecciona otra."),n.value="")})}))});document.querySelector(".header");let c=1;const s=m(".navBarMenu"),d=m(".header__navBar__line:nth-of-type(1)"),u=m(".header__navBar__line:nth-of-type(2)");m(".header__navBar").addEventListener("click",()=>{d.style.animation="navBarClickedLine1 0.5s Forwards",u.style.animation="navBarClickedLine2 0.5s Forwards",c==1?(c++,s.style.animation="navBarShow 1s forwards"):(c--,s.style.animation="navBarHide 1s forwards",d.style.animation="navBarClosingLine1 0.5s Forwards",u.style.animation="navBarClosingLine2 0.5s Forwards")});let p=E(".navBarMenu a");for(let t=0;t<p.length;t++)p[t].addEventListener("click",()=>{d.style.animation="navBarClickedLine1 0.5s Forwards",u.style.animation="navBarClickedLine2 0.5s Forwards",c==1?(c++,s.style.animation="navBarShow 1s forwards"):(c--,s.style.animation="navBarHide 1s forwards",d.style.animation="navBarClosingLine1 0.5s Forwards",u.style.animation="navBarClosingLine2 0.5s Forwards")});let v=y("hideMenuClose");for(let t=0;t<v.length;t++)v[t].addEventListener("click",()=>{c==2&&(c--,s.style.animation="navBarHide 1s forwards",d.style.animation="navBarClosingLine1 0.5s Forwards",u.style.animation="navBarClosingLine2 0.5s Forwards")});document.addEventListener("DOMContentLoaded",function(){const t=document.getElementById("ver-perfil-btn");t&&t.addEventListener("click",function(){fetch("/ver_perfil",{method:"GET",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content"),Accept:"application/json"}}).then(e=>e.json()).then(e=>{let r=`
                    Nombre: ${e.name}
                    Apellido: ${e.Apellido}
                    Dirección: ${e.Dirección}
                    Piso: ${e.Piso}
                    Departamento: ${e.Departamento}
                    Localidad: ${e.Localidad}
                    Teléfono: ${e.Teléfono}
                    Celular: ${e.Celular}
                    Email: ${e.email}
                `;alert(r)}).catch(e=>{console.error("Error:",e),alert("Hubo un error al obtener los datos del perfil.")})})});document.addEventListener("DOMContentLoaded",function(){const t=document.querySelector('meta[name="csrf-token"]');if(!t){console.error("El meta CSRF token no está presente en el DOM.");return}const e=t.getAttribute("content");if(!e){console.error("El atributo content del CSRF token está vacío.");return}const r=document.getElementById("borrarPerfilButton");if(!r){console.error('No se encontró el botón con ID "borrarPerfilButton".');return}r.addEventListener("click",function(){confirm("¿Estás seguro de que deseas borrar tu perfil? Esta acción no se puede deshacer.")&&fetch("/borrar_perfil",{method:"DELETE",headers:{"X-CSRF-TOKEN":e,Accept:"application/json"}}).then(o=>{if(!o.ok)throw new Error("Error en la respuesta del servidor");return o.json()}).then(o=>{alert(o.message||"Perfil borrado exitosamente."),window.location.href="/"}).catch(o=>{console.error("Error:",o),alert("Hubo un problema al borrar el perfil.")})})});document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll(".eliminar-btn").forEach(e=>{e.addEventListener("click",function(r){r.preventDefault();const o=this.dataset.id;confirm("¿Estás seguro de que deseas eliminar este producto del carro?")&&fetch(`/carro/remover/${o}`,{method:"DELETE",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content"),Accept:"application/json"}}).then(a=>a.json()).then(a=>{if(a.success){document.getElementById(`producto-${o}`).remove();const i=document.getElementById("contador-carrito");i&&a.nuevaCantidad!==void 0&&(i.textContent=a.nuevaCantidad)}else alert(a.message||"Error al eliminar el producto")}).catch(a=>{console.error("Error:",a),alert("Ocurrió un error al intentar eliminar el producto.")})})})});
